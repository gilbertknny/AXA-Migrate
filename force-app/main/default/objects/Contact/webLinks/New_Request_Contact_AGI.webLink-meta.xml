<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>New_Request_Contact_AGI</fullName>
    <availability>online</availability>
    <description>New Request AGI</description>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>New Request</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/53.0/connection.js&quot;)} 
{!REQUIRESCRIPT(&quot;/soap/ajax/53.0/apex.js&quot;)} 
{!REQUIRESCRIPT(&quot;/support/console/40.0/integration.js&quot;)} 
/* 
var urlRequest = &quot;/500/e?retURL=/{!Contact.Id}&amp;def_contact_id={!Contact.Id}&amp;def_account_id={!Account.Id}&amp;RecordType={!Contact.Request_RecordTypeId_Keeper__c}&amp;00N9000000CD53R=0&amp;cas5=Request&amp;ent=Case&quot;; 
*/ 

var urlRequest = &quot;/apex/CaseRequestLayoutContact_AGI?retURL=/{!Contact.Id}&amp;def_contact_id={!Contact.Id}&amp;def_account_id={!Account.Id}&amp;RecordType={!Contact.Request_RecordTypeId_Keeper__c}&amp;00N9000000CD53R=0&amp;cas5=Request&amp;ent=Case&amp;&amp;cas11=none&quot;; 

if (sforce.console.isInConsole()) { 
var focusedPrimaryTabId, allPrimaryTabIds; 
(function (c) { 
&quot;use strict&quot;; 

c.getFocusedPrimaryTabId(function (result) { 
focusedPrimaryTabId = result.id; 
}); 
c.getPrimaryTabIds(function (result) { 
allPrimaryTabIds = result.ids; 
}); 
})(sforce.console); 

sforce.console.openSubtab(focusedPrimaryTabId, urlRequest, true, &apos;Create New Request&apos;, null,null, &apos;contactrequesttab&apos;); 
sforce.console.focusSubtabByNameAndPrimaryTabId(&apos;contactrequesttab&apos;, focusedPrimaryTabId); 

}else { 
window.location.href = urlRequest; 
}</url>
</WebLink>
