<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Change_to_Request_AGI</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Change to Request AGI</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/10.0/connection.js&quot;)} 
{!REQUIRESCRIPT(&quot;/soap/ajax/10.0/apex.js&quot;)} 
{!REQUIRESCRIPT(&quot;/support/console/26.0/integration.js&quot;)} 

var urlRequest = &quot;/apex/CaseRequestLayout_AGI?retURL=/{!Case.Id}&amp;cas3={!Case.ContactId}&amp;cas4={!Case.AccountId}&amp;RecordType={!Case.Request_Recordtype_ID__c}&amp;cas5=Request&amp;cas11=email&amp;cas14={!URLENCODE(Case.Subject)}&amp;ent=Case&quot;; 

/* 
if (sforce.console.isInConsole()) { 
sforce.console.getEnclosingTabId(function(enclosingResult){ 
sforce.console.getEnclosingPrimaryTabId(function(){ 
sforce.console.openPrimaryTab(null, urlRequest, true, &apos;Create New Request&apos;, null); 
}); 
}); 
}else { 
window.location.href = urlRequest; 
} 
*/ 

var caseList = sforce.connection.query(&quot;SELECT Id, ContactId FROM Case WHERE id =&apos;{!Case.Id}&apos;&quot;); 
var records = caseList.getArray(&quot;records&quot;); 

for (var i=0; i&lt; records.length; i++) { 
var conId = records[i].ContactId ; 
} 

if(conId==null){ 
alert(&apos;Contact Name tidak boleh kosong!&apos;); 
}else{ 
if (sforce.console.isInConsole()) { 
sforce.console.getEnclosingTabId(function(enclosingResult){ 
sforce.console.getEnclosingPrimaryTabId(function(){ 
sforce.console.openPrimaryTab(null, urlRequest, true, &apos;Change To Request&apos;, null); 
}); 
}); 
}else { 
window.location.href = urlRequest; 
} 
}</url>
</WebLink>
