<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Walk_In</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Walk In</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/53.0/connection.js&quot;)}
{!REQUIRESCRIPT(&quot;/soap/ajax/53.0/apex.js&quot;)}
{!REQUIRESCRIPT(&quot;/support/console/40.0/integration.js&quot;)}

// identify the record
var o = new sforce.SObject(&quot;Contact&quot;);
o.id = &quot;{!Contact.Id}&quot;;

// check, apakah ada yang open, jika ada, tidak boleh create baru.
var dresult = sforce.connection.query(&quot;Select Id, Survey_URL__c,Case__r.isSurvey__c from Email_Sms_Log__c WHERE Contact__c = &apos;&quot;+&quot;{!Contact.Id}&quot;+&quot;&apos; and ICF_Walk_IN__c != &apos;&apos; and Survey_URL__c != &apos;&apos; and Case__r.isSurvey__c != true order by CreatedDate Desc LIMIT 1&quot;);

var drecords = dresult.getArray(&apos;records&apos;);

if (drecords.length &gt; 0) {
var result = drecords;

//alert(&apos;URL : &apos;+ result[0].Survey_URL__c);
window.open(&apos;/apex/VF_generateSurveyQR?id=&apos; + o.id, &apos;Popup&apos;, &apos;width=600,height=400&apos;);
} else {
alert(&apos;No ICF is currently available or ICF already filled.&apos;);
}</url>
</WebLink>
