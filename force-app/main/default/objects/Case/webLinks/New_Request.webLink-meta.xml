<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>New_Request</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>New Request</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/10.0/connection.js&quot;)} 
{!REQUIRESCRIPT(&quot;/soap/ajax/10.0/apex.js&quot;)} 
{!REQUIRESCRIPT(&quot;/support/console/26.0/integration.js&quot;)} 
/* 
var urlRequest = &quot;/500/e?retURL=/{!Contact.Id}&amp;def_contact_id={!Contact.Id}&amp;def_account_id={!Account.Id}&amp;RecordType={!Contact.Request_RecordTypeId_Keeper__c}&amp;00N9000000CD53R=0&amp;cas5=Request&amp;ent=Case&quot;; 
*/ 

var urlRequest = &quot;/apex/CaseRequestLayoutContact?retURL=/{!Case.Id}&amp;def_contact_id={!Case.ContactId}&amp;def_account_id={!Case.AccountId}&amp;RecordType={!Case.Request_Recordtype_ID__c}&amp;cas5=Request&amp;ent=Case&amp;cas11=none&amp;idcase={!Case.Id}&quot;; 


var parent = &quot;{!Case.ParentId}&quot;;

if(parent!= &quot;&quot;){
alert(&quot;Cannot create case from child&quot;);
}
else{
if (sforce.console.isInConsole()) { 
sforce.console.getEnclosingTabId(function(enclosingResult){ 
sforce.console.getEnclosingPrimaryTabId(function(){ 
sforce.console.openPrimaryTab(null, urlRequest, true, &apos;Create New Request&apos;, null); 
}); 
}); 

}else { 
window.location.href = urlRequest; 
}
}</url>
</WebLink>
