<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Refresh</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>Refresh</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>{!REQUIRESCRIPT(&quot;/soap/ajax/44.0/connection.js&quot;)} 
{!REQUIRESCRIPT(&quot;/soap/ajax/44.0/apex.js&quot;)} 

var profileName = &quot;{!User.Profile}&quot;;

if(profileName.includes(&quot;Agent&quot;)) {
alert(&quot;You are not allowed to use this feature.&quot;);
} else {
if(confirm(&apos;Do you really want to refresh KPI Item?&apos;)) {
sforce.apex.execute(&quot;InvokeClass&quot;,&quot;KpiItemRefresh&quot;,{kpiId:&quot;{!Agent_KPI__c.Id}&quot;}); 
window.location.reload();
}
}</url>
</WebLink>
